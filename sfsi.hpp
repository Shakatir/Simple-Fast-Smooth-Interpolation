/*

This is free and unencumbered software released into the public domain.

Anyone is free to copy, modify, publish, use, compile, sell, or
distribute this software, either in source code form or as a compiled
binary, for any purpose, commercial or non-commercial, and by any
means.

In jurisdictions that recognize copyright laws, the author or authors
of this software dedicate any and all copyright interest in the
software to the public domain. We make this dedication for the benefit
of the public at large and to the detriment of our heirs and
successors. We intend this dedication to be an overt act of
relinquishment in perpetuity of all present and future rights to this
software under copyright law.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

For more information, please refer to <http://unlicense.org/>

*/

////////////////////    Documentation    ///////////////////////////////////////
/*

Simple Fast Smooth Interpolation
================================

Original Author: Benjamin Dreyer

Quick Start
-----------

1. Include this header in your code. It has no dependencies (not even to the
	standard library), so including it anywhere should cause no issues. You may
	even wrap it in another namespace of your choice if you so please.
2. Use the interpolation function as follows:
		shakatir::sfsi::interpolate<FLOAT, S1, ..., SN>(FUNCTION, X1, ..., XN)
	The parameters are:
	- `FLOAT`: You probably want this to be `float`, `double` or `long double`,
		but any numeric type that behaves similar to a built-in floating point
		type will suffice. In particular the type has to be:
		- default-constructible, copy-constructible and copy-assignable,
		- constructible from `long long` via `static_cast<FLOAT>(...)`,
		- supporting binary arithmetic operators `+`, `-`, `*` and `/`.
		Results are likely not meaningful if the type does not model an
		approximation of the real numbers. The code will likely be slow if the
		resulting type is not trivially copyable and trivially destructible.
	- `S1, ..., SN`: The *smoothness parameters*. For each dimension you pass an
		individual template parameter that determines how smooth the
		interpolation in that dimension is supposed to be. The parameters are
		positive integer values and have the following interpolation behaviors:
		- `1`: Bilinear interpolation. Produces a zig-zag pattern by drawing a
			straight line between two ajacent points. Requires a neighborhood at
			indices `{0, 1}`.
		- `2`: Bicubic interpolation. Continuous in the first derivative.
			Requires an environment at indices `{-1, 0, 1, 2}`.
		- `3`: Continuous in the first and second derivative. This is likely the
			highest value you will need. Requires a neighborhood at	indices
			`{-2, -1, 0, 1, 2, 3}`.
		- `4` or higher: For the paranoid. Makes a *mathematically* smoother
			curve at the risk of having more extreme swings to the naked eye
			(the same risk that lies in all spline interpolations using
			polynomials of high degree). The highest supported value as of now
			is `10` as higher values would cause an overflow of the signed
			64-bit integers in the precomputed table.
		Generally a smoothness of `S` produces a function that is continuous in
		the first `S-1` derivatives and requires a neighborhood at indices
		`{1-S, 2-S, ..., S}`.
	- `FUNCTION`: a functor that when called with integer arguments returns a
		value implicitly convertible to `FLOAT`. The functor will be called as
		follows:
			FUNCTION(i1, ..., iN)
		`i1` is an integer in the environment of `S1`, `i2` lies in the
		environment of `S2` and so on. Each possible combination of indices will
		be used for a total of `(2 * S1) * (2 * S2) * ... * (2 * SN)` values in
		the `N`-dimensional environment.
	- `X1, ..., XN`: Coefficients of type `FLOAT` giving the position at which
		the interpolated value shall be calculated. For the purpose of
		interpolation, each value should lie within the range of 0 and 1, but if
		they fall outside that range, it will simply result in an
		*extrapolation* of the interpolation. In particular, small rounding
		errors in the input won't break the result.

Examples:
- 1D bilinear interpolation between two points:

		float seed[2]{ ... };
		float x = ...;
		float result = interpolate<float, 1>([&seed](int i){ return seed[i]; }, x);

- 2D bicubic interpolation of a 4-by-4 neighborhood:

		double seed[4][4]{ ... };
		double x = ..., y = ...;
		double result = interpolate<double, 2, 2>([&seed](int i, int j){ return seed[i + 1][j + 1]; }, x, y);

	Note how we add 1 to map the range `-1, .., 2` to the range `0, ..., 3`.
- 1D bicubic interpolation where the position can range over several integers:

		float seed[10]{ ... };
		float x = ...;
		int j = static_cast<int>(x);
		float result = interpolate<float, 2>([&seed, j](int i){ return seed[i + j + 1]; }, x - j);

	Note that the interpolation will be a smooth and continuous function over
	the entire interval of `0 <= x < 8`, but it will actually be joined together
	from 8 individual slices.

- 3D interpolation with mixed smoothness and procedural, cyclical neighborhood:

		int (*hash)(int, int, int) = ...;
		double x = ..., y = ..., z = ...;
		int xi = (int)x, yi = (int)y, zi = (int)z;
		double result = interpolate<double, 2, 1, 3>(
			[hash, xi, yi, zi](int i, int j, int k){
				return (hash((xi + i) & 15, (yi + j) & 15, (zi + k) & 15) % 1025) / 1024.0.0;
			}, x - xi, y - yi, z - zi);

What is this?
-------------

This library provides a family of interpolation functions that map an arbitrary
number of real numbers onto a single real value. They are related to the bicubic
interpolation known from image editing, however neither is a generalization over
the other.

The potential use case is interpolation of data that is known in a regular
pattern, for example:
- creating a landscape from a heightmap or from procedurally generated reference
	points,
- calculating intermediate positions of a smooth animation.

Features of this library are:
- Single-header, header-only: Just include it in your codefile in whatever way
	suits you best.
- Standard compliant: The library makes no use of platform dependent features
	like intrinsics. It relies on the compiler's ability to generate efficient
	assembly. Any standard compliant compiler with support for C++14 and later
	should be able to compile this file.
- Zero dependencies: This header includes no other headers---not even from the
	standard library.
- Low memory footprint: On modern x64 processors and with proper optimization,
	the stack won't even be touched at all for lower degree interpolations. No
	heap allocations will be performed.
- Fast: The code was written with auto-vectorization in mind and produces decent
	results (`clang -O2 -ffast-math` or `gcc -O3 -ffast-math`). MSVC
	unfortunately struggles a lot to produce decent assembly (likely due to
	heavy inlining).
- Type generic: The library functions are mostly intended for usage with
	`float`, `double` and `long double`, but any type that supports copying,
	addition, multiplication, division and conversion from `int` and `long long`
	is suitable.
- `constexpr` compatible: If the type argument supports `constexpr`, so will the
	functions in this library. If not, the functions remain usable for runtime
	evaluation.
- Almost no hard-coded limits: The degree of smoothness is capped at 10 which is
	far above anything anybody could reasonably desire. The number of dimensions
	is truly unlimited. Template instantiation depth and constexpr evaluation
	step limit will be the limiting factors.

Limitations of the library are:
- Heavily templated: consequences can be code bloat and high compilation times.
	As a consequence, this library is best used by including it in a code file
	that provides functions more closely tailored to your specific use case.
- Requires reference points to be arranged in an integer grid. Arbitrary
	reference points require a more sophisticated spline-interpolation algorithm.
- Poor performance for non-trivial types: The implementation assumes copying and
	destruction to be cheap operations (at least compared to addition and
	multiplication). Performance for types like `mpf_class` from GMP or types from
	the `boost::multiprecision` library that allocate heap memory is likely to
	suffer.
- Unstable optimization: Level and quality of optimization and thus the ultimate
	runtime performance can heavily rely on a multitude of factors. Among other
	things: compiler vendor and version, compiler settings, runtime platform ...
	Optimization will become more unreliable the larger the parameters (number of
	dimensions, degrees of smoothness, size of type parameter).
- NOT SUITABLE FOR SCIENTIFIC OR PRECISION ENGINEERING PURPOSES: The
	implementation was written to be one thing first and foremost: short. That
	means in turn that other things like minimization of rounding errors were
	not deemed of utmost importance. In fact, it is recommended to compile the
	code with switches like `-ffast-math` enabled to get that extra boost in
	performance, since the reordering of operations done by the compiler is
	unlikely to significantly worsen the quality of the results.

How does it work?
-----------------

The short version is that for an interpolation of `N`-th Degree, there is a
`2*N` by `2*N` matrix `M(N)` that when multiplied with a vector containing the
neighborhood on the left and a vector containing the powers of `x` until the
exponent `2*N-1` on the right will yield the interpolated value at position `x`:

	result = {a(1-N), a(2-N) ..., a(N-1), a(N)} * M(N) * {1, x, x^2, ..., x^(2*N-1)}^T

Interpolation in multiple dimensions is equivalent to interpolation in one
dimension after the other. So the bulk of the effort lies in pre-computing the
matrices that we need to implement the algorithm. For this library this has been
done up to the 10th degree. Higher degrees are theoretically possible, but
exceed the limits imposed by our usage of `long long` as numerator and
denominator of the matrix elements. It is also extremely unlikely that you will
ever even need or want a degree greater than 4.

The runtime complexity lies somewhere around:
	O(S1 * S2 * ... * SN + S1*S1 + S2*S2 + ... + SN*SN)
The memory complexity is roughly:
	O(S1 + S2 + ... + SN + max(S1*S1, S2*S2, ..., SN*SN))

Q & A
-----

- Why would anybody use this?

	Ultimately this is a utility that can complement noise functions or any sort
	of creation process where a smooth interpolation is desired. It is not very
	well optimized and functions more as a proof of concept. However, if you
	ever have some sort of data consisting of grid-aligned reference points
	(e. g. a heightmap in an open world game) and wish a smooth interpolation
	that does only depend on local information, this library can be a useful
	utility at least until you get to the stage of low-level optimization in
	your project. You can also take the matrix data and implement similar
	interpolation algorithms in GPU shaders.

- What's up with the identifiers?

	All identifiers that are not part of the library's interface start with an
	underscore followed by a lowercase letter. According to the standard, all
	such identifiers are reserved at file scope, but free to use on all inner
	scopes (including within namespaces). This puts them at the unique postion
	of being the only identifiers that are *guaranteed* by the standard to not
	be macros. Thus I chose to implement the library using only such
	identifiers. If there are any name collisions whatsoever, the error likely
	lies outside of this header file.

	If you're a language lawyer, insisting that it's a terrible idea, feel free
	to write a lengthy blogpost about it.

- Am I allowed to use this in my project?

	Yes. As indicated above, this header file is published under the Unlicense,
	meaning that you're free to use it for whatever purpose you seem fit. Under
	no circumstances are you obliged to seek my approval, give credit or share
	profits made from the usage of this header. 
	
*/
#ifndef SHAKATIR_SFSI_HPP_INCLUDED
#define SHAKATIR_SFSI_HPP_INCLUDED

namespace shakatir
{
namespace sfsi
{

namespace _detail
{

template<int _pSmth> struct _ci_matrix_data_wrapper;

////////////////////////////////////////////////////////////////////////////////
// BEGIN OF AUTOMATICALLY GENERATED DATA - DO NOT MODIFY!
////////////////////////////////////////////////////////////////////////////////
/*
Matrices are square, column major and contain numerators at even indices and
denominators at odd indices.
*/
constexpr long long _ci_matrix_data_1[8]{
	1LL, 1LL, 0LL, 1LL, -1LL, 1LL, 1LL, 1LL
};

template<> struct _ci_matrix_data_wrapper<1> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_1; } };

constexpr long long _ci_matrix_data_2[32]{
	0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, -1LL, 2LL, 0LL, 1LL, 1LL, 2LL, 0LL, 1LL, 1LL, 1LL, -5LL, 2LL, 2LL, 1LL,
	-1LL, 2LL, -1LL, 2LL, 3LL, 2LL, -3LL, 2LL, 1LL, 2LL
};

template<> struct _ci_matrix_data_wrapper<2> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_2; } };

constexpr long long _ci_matrix_data_3[72]{
	0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 12LL, -2LL, 3LL, 0LL, 1LL, 2LL, 3LL, -1LL, 12LL,
	0LL, 1LL, -1LL, 24LL, 2LL, 3LL, -5LL, 4LL, 2LL, 3LL, -1LL, 24LL, 0LL, 1LL, -3LL, 8LL, 13LL, 8LL, -35LL, 12LL, 11LL,
	4LL, -11LL, 8LL, 7LL, 24LL, 13LL, 24LL, -8LL, 3LL, 21LL, 4LL, -31LL, 6LL, 61LL, 24LL, -1LL, 2LL, -5LL, 24LL, 25LL,
	24LL, -25LL, 12LL, 25LL, 12LL, -25LL, 24LL, 5LL, 24LL
};

template<> struct _ci_matrix_data_wrapper<3> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_3; } };

constexpr long long _ci_matrix_data_4[128]{
	0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, -1LL, 60LL, 3LL, 20LL, -3LL, 4LL,
	0LL, 1LL, 3LL, 4LL, -3LL, 20LL, 1LL, 60LL, 0LL, 1LL, 1LL, 180LL, -3LL, 40LL, 3LL, 4LL, -49LL, 36LL, 3LL, 4LL, -3LL,
	40LL, 1LL, 180LL, 0LL, 1LL, 1LL, 48LL, -1LL, 6LL, 13LL, 48LL, 0LL, 1LL, -13LL, 48LL, 1LL, 6LL, -1LL, 48LL, 0LL,
	1LL, 7LL, 36LL, -191LL, 144LL, 95LL, 24LL, -959LL, 144LL, 61LL, 9LL, -199LL, 48LL, 101LL, 72LL, -29LL, 144LL, -37LL,
	72LL, 2581LL, 720LL, -429LL, 40LL, 2569LL, 144LL, -1283LL, 72LL, 171LL, 16LL, -1283LL, 360LL, 367LL, 720LL, 13LL,
	30LL, -2183LL, 720LL, 1091LL, 120LL, -727LL, 48LL, 545LL, 36LL, -2179LL, 240LL, 121LL, 40LL, -311LL, 720LL, -89LL,
	720LL, 623LL, 720LL, -623LL, 240LL, 623LL, 144LL, -623LL, 144LL, 623LL, 240LL, -623LL, 720LL, 89LL, 720LL
};

template<> struct _ci_matrix_data_wrapper<4> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_4; } };

constexpr long long _ci_matrix_data_5[200]{
	0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 280LL,
	-4LL, 105LL, 1LL, 5LL, -4LL, 5LL, 0LL, 1LL, 4LL, 5LL, -1LL, 5LL, 4LL, 105LL, -1LL, 280LL, 0LL, 1LL, -1LL, 1120LL,
	4LL, 315LL, -1LL, 10LL, 4LL, 5LL, -205LL, 144LL, 4LL, 5LL, -1LL, 10LL, 4LL, 315LL, -1LL, 1120LL, 0LL, 1LL, -7LL,
	1440LL, 1LL, 20LL, -169LL, 720LL, 61LL, 180LL, 0LL, 1LL, -61LL, 180LL, 169LL, 720LL, -1LL, 20LL, 7LL, 1440LL, 0LL,
	1LL, 7LL, 5760LL, -1LL, 60LL, 169LL, 1440LL, -61LL, 180LL, 91LL, 192LL, -61LL, 180LL, 169LL, 1440LL, -1LL, 60LL,
	7LL, 5760LL, 0LL, 1LL, -175LL, 1152LL, 175LL, 128LL, -1579LL, 288LL, 3697LL, 288LL, -6181LL, 320LL, 11149LL, 576LL,
	-3719LL, 288LL, 177LL, 32LL, -1591LL, 1152LL, 883LL, 5760LL, 503LL, 960LL, -2263LL, 480LL, 13577LL, 720LL, -31681LL,
	720LL, 6337LL, 96LL, -2971LL, 45LL, 31697LL, 720LL, -4529LL, 240LL, 13589LL, 2880LL, -151LL, 288LL, -1961LL, 2880LL,
	41179LL, 6720LL, -30883LL, 1260LL, 5147LL, 90LL, -2745LL, 32LL, 123523LL, 1440LL, -20587LL, 360LL, 2941LL, 120LL,
	-123523LL, 20160LL, 305LL, 448LL, 16061LL, 40320LL, -36137LL, 10080LL, 144547LL, 10080LL, -24091LL, 720LL, 28909LL,
	576LL, -4517LL, 90LL, 48181LL, 1440LL, -72271LL, 5040LL, 144541LL, 40320LL, -803LL, 2016LL, -3569LL, 40320LL, 3569LL,
	4480LL, -3569LL, 1120LL, 3569LL, 480LL, -3569LL, 320LL, 3569LL, 320LL, -3569LL, 480LL, 3569LL, 1120LL, -3569LL,
	4480LL, 3569LL, 40320LL
};

template<> struct _ci_matrix_data_wrapper<5> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_5; } };

constexpr long long _ci_matrix_data_6[288]{
	0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL,
	1LL, -1LL, 1260LL, 5LL, 504LL, -5LL, 84LL, 5LL, 21LL, -5LL, 6LL, 0LL, 1LL, 5LL, 6LL, -5LL, 21LL, 5LL, 84LL, -5LL,
	504LL, 1LL, 1260LL, 0LL, 1LL, 1LL, 6300LL, -5LL, 2016LL, 5LL, 252LL, -5LL, 42LL, 5LL, 6LL, -5269LL, 3600LL, 5LL,
	6LL, -5LL, 42LL, 5LL, 252LL, -5LL, 2016LL, 1LL, 6300LL, 0LL, 1LL, 41LL, 36288LL, -1261LL, 90720LL, 541LL, 6720LL,
	-4369LL, 15120LL, 1669LL, 4320LL, 0LL, 1LL, -1669LL, 4320LL, 4369LL, 15120LL, -541LL, 6720LL, 1261LL, 90720LL, -41LL,
	36288LL, 0LL, 1LL, -41LL, 181440LL, 1261LL, 362880LL, -541LL, 20160LL, 4369LL, 30240LL, -1669LL, 4320LL, 1529LL,
	2880LL, -1669LL, 4320LL, 4369LL, 30240LL, -541LL, 20160LL, 1261LL, 362880LL, -41LL, 181440LL, 0LL, 1LL, -13LL, 34560LL,
	19LL, 4320LL, -29LL, 1280LL, 13LL, 240LL, -323LL, 5760LL, 0LL, 1LL, 323LL, 5760LL, -13LL, 240LL, 29LL, 1280LL, -19LL,
	4320LL, 13LL, 34560LL, 0LL, 1LL, 32071LL, 259200LL, -705703LL, 518400LL, 176479LL, 25920LL, -706069LL, 34560LL,
	353051LL, 8640LL, -4942069LL, 86400LL, 617597LL, 10800LL, -705601LL, 17280LL, 352697LL, 17280LL, -705247LL, 103680LL,
	176293LL, 129600LL, -64103LL, 518400LL, -278653LL, 518400LL, 21456371LL, 3628800LL, -21456689LL, 725760LL, 4291423LL,
	48384LL, -21457553LL, 120960LL, 21457931LL, 86400LL, -21458201LL, 86400LL, 3065477LL, 17280LL, -4291669LL, 48384LL,
	21458243LL, 725760LL, -21458081LL, 3628800LL, 1950721LL, 3628800LL, 28633LL, 30240LL, -41995LL, 4032LL, 3149623LL,
	60480LL, -2099749LL, 13440LL, 1574813LL, 5040LL, -314963LL, 720LL, 629927LL, 1440LL, -6299281LL, 20160LL, 524941LL,
	3360LL, -3149651LL, 60480LL, 209977LL, 20160LL, -114533LL, 120960LL, -612527LL, 725760LL, 481271LL, 51840LL, -33688957LL,
	725760LL, 16844473LL, 120960LL, -33688937LL, 120960LL, 3368893LL, 8640LL, -1347557LL, 3456LL, 16844461LL, 60480LL,
	-4812703LL, 34560LL, 16844461LL, 362880LL, -1347557LL, 145152LL, 306263LL, 362880LL, 27589LL, 72576LL, -722569LL,
	172800LL, 3793487LL, 181440LL, -15173947LL, 241920LL, 280999LL, 2240LL, -3034789LL, 17280LL, 1896743LL, 10800LL,
	-5057981LL, 40320LL, 1083853LL, 17280LL, -15173941LL, 725760LL, 252899LL, 60480LL, -1379449LL, 3628800LL, -83603LL,
	1209600LL, 919633LL, 1209600LL, -919633LL, 241920LL, 919633LL, 80640LL, -919633LL, 40320LL, 919633LL, 28800LL, -919633LL,
	28800LL, 919633LL, 40320LL, -919633LL, 80640LL, 919633LL, 241920LL, -919633LL, 1209600LL, 83603LL, 1209600LL
};

template<> struct _ci_matrix_data_wrapper<6> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_6; } };

constexpr long long _ci_matrix_data_7[392]{
	0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL,
	1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 5544LL, -1LL, 385LL, 1LL, 56LL, -5LL, 63LL, 15LL, 56LL, -6LL, 7LL, 0LL, 1LL, 6LL,
	7LL, -15LL, 56LL, 5LL, 63LL, -1LL, 56LL, 1LL, 385LL, -1LL, 5544LL, 0LL, 1LL, -1LL, 33264LL, 1LL, 1925LL, -1LL, 224LL,
	5LL, 189LL, -15LL, 112LL, 6LL, 7LL, -5369LL, 3600LL, 6LL, 7LL, -15LL, 112LL, 5LL, 189LL, -1LL, 224LL, 1LL, 1925LL,
	-1LL, 33264LL, 0LL, 1LL, -479LL, 1814400LL, 19LL, 5040LL, -643LL, 25200LL, 4969LL, 45360LL, -4469LL, 13440LL, 1769LL,
	4200LL, 0LL, 1LL, -1769LL, 4200LL, 4469LL, 13440LL, -4969LL, 45360LL, 643LL, 25200LL, -19LL, 5040LL, 479LL, 1814400LL,
	0LL, 1LL, 479LL, 10886400LL, -19LL, 25200LL, 643LL, 100800LL, -4969LL, 136080LL, 4469LL, 26880LL, -1769LL, 4200LL,
	37037LL, 64800LL, -1769LL, 4200LL, 4469LL, 26880LL, -4969LL, 136080LL, 643LL, 100800LL, -19LL, 25200LL, 479LL, 10886400LL,
	0LL, 1LL, 139LL, 1451520LL, -121LL, 90720LL, 625LL, 72576LL, -3011LL, 90720LL, 33853LL, 483840LL, -1039LL, 15120LL,
	0LL, 1LL, 1039LL, 15120LL, -33853LL, 483840LL, 3011LL, 90720LL, -625LL, 72576LL, 121LL, 90720LL, -139LL, 1451520LL,
	0LL, 1LL, -139LL, 8709120LL, 121LL, 453600LL, -625LL, 290304LL, 3011LL, 272160LL, -33853LL, 967680LL, 1039LL, 15120LL,
	-44473LL, 518400LL, 1039LL, 15120LL, -33853LL, 967680LL, 3011LL, 272160LL, -625LL, 290304LL, 121LL, 453600LL, -139LL,
	8709120LL, 0LL, 1LL, -644497LL, 6220800LL, 8378479LL, 6220800LL, -1675691LL, 207360LL, 92161379LL, 3110400LL, -92158499LL,
	1244160LL, 92155001LL, 691200LL, -645061703LL, 3628800LL, 3685967LL, 20736LL, -92147879LL, 691200LL, 92147789LL,
	1244160LL, -92148581LL, 3110400LL, 8377249LL, 1036800LL, -1675469LL, 1244160LL, 4510921LL, 43545600LL, 318527LL,
	580608LL, -25880341LL, 3628800LL, 103521473LL, 2419200LL, -569368571LL, 3628800LL, 1138737557LL, 2903040LL, -4744739LL,
	6720LL, 162676657LL, 172800LL, -569367709LL, 604800LL, 1138734017LL, 1612800LL, -284683153LL, 725760LL, 227746279LL,
	1451520LL, -51760477LL, 1209600LL, 103520903LL, 14515200LL, -142199LL, 259200LL, -53326271LL, 43545600LL, 693241553LL,
	43545600LL, -693241613LL, 7257600LL, 7625658583LL, 21772800LL, -7625659477LL, 8709120LL, 7625660323LL, 4838400LL,
	-1089380149LL, 518400LL, 7625661583LL, 3628800LL, -7625661913LL, 4838400LL, 7625662027LL, 8709120LL, -7625661943LL,
	21772800LL, 693241973LL, 7257600LL, -693241943LL, 43545600LL, 7618043LL, 6220800LL, 12827359LL, 8709120LL, -104222291LL,
	5443200LL, 33351133LL, 290304LL, -458578079LL, 1088640LL, 9171561617LL, 8709120LL, -114644521LL, 60480LL, 1310223109LL,
	518400LL, -458578093LL, 181440LL, 1834312393LL, 967680LL, -1146445259LL, 1088640LL, 366862487LL, 870912LL, -208444597LL,
	1814400LL, 166755679LL, 8709120LL, -11453LL, 7776LL, -108089LL, 107520LL, 695552713LL, 53222400LL, -6259974401LL,
	79833600LL, 2086658129LL, 7257600LL, -417331625LL, 580608LL, 1251994873LL, 967680LL, -298094017LL, 172800LL, 2086658117LL,
	1209600LL, -6259974347LL, 4838400LL, 139110541LL, 193536LL, -139110541LL, 483840LL, 569088577LL, 7257600LL, -2086658117LL,
	159667200LL, 22930309LL, 22809600LL, 176631449LL, 479001600LL, -574052209LL, 119750400LL, 51026863LL, 1774080LL,
	-1148104417LL, 10886400LL, 2296208833LL, 8709120LL, -11959421LL, 25200LL, 328029833LL, 518400LL, -229620883LL, 362880LL,
	765402943LL, 1612800LL, -574052207LL, 2177280LL, 2296208827LL, 21772800LL, -127567157LL, 4435200LL, 91848353LL,
	19160064LL, -3154133LL, 8553600LL, -1006447LL, 17740800LL, 13083811LL, 17740800LL, -13083811LL, 2956800LL, 13083811LL,
	806400LL, -13083811LL, 322560LL, 13083811LL, 179200LL, -13083811LL, 134400LL, 13083811LL, 134400LL, -13083811LL,
	179200LL, 13083811LL, 322560LL, -13083811LL, 806400LL, 13083811LL, 2956800LL, -13083811LL, 17740800LL, 1006447LL,
	17740800LL
};

template<> struct _ci_matrix_data_wrapper<7> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_7; } };

constexpr long long _ci_matrix_data_8[512]{
	0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL,
	1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, -1LL, 24024LL, 7LL, 10296LL, -7LL, 1320LL, 7LL, 264LL, -7LL, 72LL,
	7LL, 24LL, -7LL, 8LL, 0LL, 1LL, 7LL, 8LL, -7LL, 24LL, 7LL, 72LL, -7LL, 264LL, 7LL, 1320LL, -7LL, 10296LL, 1LL, 24024LL,
	0LL, 1LL, 1LL, 168168LL, -7LL, 61776LL, 7LL, 6600LL, -7LL, 1056LL, 7LL, 216LL, -7LL, 48LL, 7LL, 8LL, -266681LL,
	176400LL, 7LL, 8LL, -7LL, 48LL, 7LL, 216LL, -7LL, 1056LL, 7LL, 6600LL, -7LL, 61776LL, 1LL, 168168LL, 0LL, 1LL, 59LL,
	950400LL, -20137LL, 19958400LL, 2077LL, 266112LL, -31957LL, 831600LL, 247081LL, 1814400LL, -222581LL, 604800LL,
	90281LL, 201600LL, 0LL, 1LL, -90281LL, 201600LL, 222581LL, 604800LL, -247081LL, 1814400LL, 31957LL, 831600LL, -2077LL,
	266112LL, 20137LL, 19958400LL, -59LL, 950400LL, 0LL, 1LL, -59LL, 6652800LL, 20137LL, 119750400LL, -2077LL, 1330560LL,
	31957LL, 3326400LL, -247081LL, 5443200LL, 222581LL, 1209600LL, -90281LL, 201600LL, 54613LL, 90720LL, -90281LL, 201600LL,
	222581LL, 1209600LL, -247081LL, 5443200LL, 31957LL, 3326400LL, -2077LL, 1330560LL, 20137LL, 119750400LL, -59LL,
	6652800LL, 0LL, 1LL, -37LL, 1555200LL, 2767LL, 7257600LL, -6271LL, 2177280LL, 73811LL, 5443200LL, -157477LL, 3628800LL,
	1819681LL, 21772800LL, -286397LL, 3628800LL, 0LL, 1LL, 286397LL, 3628800LL, -1819681LL, 21772800LL, 157477LL, 3628800LL,
	-73811LL, 5443200LL, 6271LL, 2177280LL, -2767LL, 7257600LL, 37LL, 1555200LL, 0LL, 1LL, 37LL, 10886400LL, -2767LL,
	43545600LL, 6271LL, 10886400LL, -73811LL, 21772800LL, 157477LL, 10886400LL, -1819681LL, 43545600LL, 286397LL, 3628800LL,
	-353639LL, 3628800LL, 286397LL, 3628800LL, -1819681LL, 43545600LL, 157477LL, 10886400LL, -73811LL, 21772800LL, 6271LL,
	10886400LL, -2767LL, 43545600LL, 37LL, 10886400LL, 0LL, 1LL, 311LL, 87091200LL, -101LL, 1814400LL, 1399LL, 3483648LL,
	-2363LL, 1360800LL, 135073LL, 29030400LL, -40987LL, 5443200LL, 184297LL, 29030400LL, 0LL, 1LL, -184297LL, 29030400LL,
	40987LL, 5443200LL, -135073LL, 29030400LL, 2363LL, 1360800LL, -1399LL, 3483648LL, 101LL, 1814400LL, -311LL, 87091200LL,
	0LL, 1LL, 6791143LL, 76204800LL, -814936169LL, 609638400LL, 81493483LL, 8709120LL, -1177125589LL, 29030400LL, 2648527163LL,
	21772800LL, -23307008299LL, 87091200LL, 19422503717LL, 43545600LL, -23307029603LL, 40642560LL, 7283461931LL, 12700800LL,
	-38845232429LL, 87091200LL, 11653600561LL, 43545600LL, -10594205917LL, 87091200LL, 19618931LL, 483840LL, -814941017LL,
	87091200LL, 407470757LL, 304819200LL, -10865891LL, 121927680LL, -84995221LL, 152409600LL, 1699904413LL, 203212800LL,
	-84995219LL, 1451520LL, 22098755873LL, 87091200LL, -87693469LL, 115200LL, 9723450923LL, 5806080LL, -60771562231LL,
	21772800LL, 48617245391LL, 13547520LL, -60771552467LL, 16934400LL, 243086199283LL, 87091200LL, -12154309777LL, 7257600LL,
	3156963607LL, 4147200LL, -1104937291LL, 4354560LL, 566634527LL, 9676800LL, -424975909LL, 50803200LL, 339980737LL,
	609638400LL, 3288953LL, 2177280LL, -1973371807LL, 87091200LL, 2302267117LL, 14515200LL, -59858945227LL, 87091200LL,
	44894208997LL, 21772800LL, -131689679729LL, 29030400LL, 329224198777LL, 43545600LL, -282192169493LL, 29030400LL,
	2939501753LL, 302400LL, -658448389421LL, 87091200LL, 197534515817LL, 43545600LL, -59858943899LL, 29030400LL, 14964735913LL,
	21772800LL, -13813602337LL, 87091200LL, 328895293LL, 14515200LL, -131558117LL, 87091200LL, -99846323LL, 43545600LL,
	10983095533LL, 319334400LL, -23064500629LL, 95800320LL, 999461694431LL, 958003200LL, -499730847487LL, 159667200LL,
	119935403461LL, 17418240LL, -166576949333LL, 14515200LL, 9518682823LL, 645120LL, -214170363587LL, 14515200LL, 999461696959LL,
	87091200LL, -99946169707LL, 14515200LL, 272580462839LL, 87091200LL, -99946169699LL, 95800320LL, 76881668987LL, 319334400LL,
	-16474643351LL, 479001600LL, 732206371LL, 319334400LL, 251945963LL, 119750400LL, -30233515559LL, 958003200LL, 21163460891LL,
	95800320LL, -101898145031LL, 106444800LL, 687812478971LL, 239500800LL, -550249983193LL, 87091200LL, 458541652679LL,
	43545600LL, -78607140463LL, 5806080LL, 6141182849LL, 453600LL, -917083305503LL, 87091200LL, 275124991667LL, 43545600LL,
	-2751249916829LL, 958003200LL, 15284721761LL, 15966720LL, -211634609009LL, 958003200LL, 15116757787LL, 479001600LL,
	-403113541LL, 191600640LL, -279217271LL, 239500800LL, 24198830153LL, 1383782400LL, -76226314981LL, 622702080LL,
	169391811067LL, 319334400LL, -127043858299LL, 79833600LL, 60981051983LL, 17418240LL, -127043858297LL, 21772800LL,
	14519298091LL, 1935360LL, -54447367841LL, 7257600LL, 508175433181LL, 87091200LL, -313688539LL, 89600LL, 1524526299539LL,
	958003200LL, -313688539LL, 591360LL, 39090417937LL, 319334400LL, -54447367841LL, 3113510400LL, 14519298091LL, 12454041600LL,
	280932929LL, 778377600LL, -471967320719LL, 87178291200LL, 235983660359LL, 6227020800LL, -52440813413LL, 319334400LL,
	117991830179LL, 239500800LL, -94393464143LL, 87091200LL, 78661220119LL, 43545600LL, -9631986137LL, 4147200LL, 58995915089LL,
	25401600LL, -157322440237LL, 87091200LL, 47196732071LL, 43545600LL, -471967320709LL, 958003200LL, 13110203353LL,
	79833600LL, -471967320707LL, 12454041600LL, 33711951479LL, 6227020800LL, -31464488047LL, 87178291200LL, -1398421691LL,
	29059430400LL, 1398421691LL, 1937295360LL, -1398421691LL, 276756480LL, 1398421691LL, 63866880LL, -1398421691LL,
	21288960LL, 1398421691LL, 9676800LL, -1398421691LL, 5806080LL, 1398421691LL, 4515840LL, -1398421691LL, 4515840LL,
	1398421691LL, 5806080LL, -1398421691LL, 9676800LL, 1398421691LL, 21288960LL, -1398421691LL, 63866880LL, 1398421691LL,
	276756480LL, -1398421691LL, 1937295360LL, 1398421691LL, 29059430400LL
};

template<> struct _ci_matrix_data_wrapper<8> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_8; } };

constexpr long long _ci_matrix_data_9[648]{
	0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL,
	1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 102960LL, -8LL, 45045LL, 2LL, 1287LL, -56LL,
	6435LL, 7LL, 198LL, -56LL, 495LL, 14LL, 45LL, -8LL, 9LL, 0LL, 1LL, 8LL, 9LL, -14LL, 45LL, 56LL, 495LL, -7LL, 198LL,
	56LL, 6435LL, -2LL, 1287LL, 8LL, 45045LL, -1LL, 102960LL, 0LL, 1LL, -1LL, 823680LL, 8LL, 315315LL, -1LL, 3861LL,
	56LL, 32175LL, -7LL, 792LL, 56LL, 1485LL, -7LL, 45LL, 8LL, 9LL, -1077749LL, 705600LL, 8LL, 9LL, -7LL, 45LL, 56LL,
	1485LL, -7LL, 792LL, 56LL, 32175LL, -1LL, 3861LL, 8LL, 315315LL, -1LL, 823680LL, 0LL, 1LL, -266681LL, 18162144000LL,
	21701LL, 81081000LL, -1058149LL, 454053600LL, 41981LL, 3243240LL, -1033649LL, 19958400LL, 999349LL, 6237000LL, -901349LL,
	2268000LL, 372149LL, 793800LL, 0LL, 1LL, -372149LL, 793800LL, 901349LL, 2268000LL, -999349LL, 6237000LL, 1033649LL,
	19958400LL, -41981LL, 3243240LL, 1058149LL, 454053600LL, -21701LL, 81081000LL, 266681LL, 18162144000LL, 0LL, 1LL,
	266681LL, 145297152000LL, -21701LL, 567567000LL, 1058149LL, 2724321600LL, -41981LL, 16216200LL, 1033649LL, 79833600LL,
	-999349LL, 18711000LL, 901349LL, 4536000LL, -372149LL, 793800LL, 63566689LL, 101606400LL, -372149LL, 793800LL, 901349LL,
	4536000LL, -999349LL, 18711000LL, 1033649LL, 79833600LL, -41981LL, 16216200LL, 1058149LL, 2724321600LL, -21701LL,
	567567000LL, 266681LL, 145297152000LL, 0LL, 1LL, 4201LL, 718502400LL, -2711LL, 25660800LL, 24149LL, 26611200LL,
	-176989LL, 35925120LL, 6782981LL, 359251200LL, -352423LL, 6652800LL, 248945LL, 2612736LL, -203617LL, 2332800LL,
	0LL, 1LL, 203617LL, 2332800LL, -248945LL, 2612736LL, 352423LL, 6652800LL, -6782981LL, 359251200LL, 176989LL, 35925120LL,
	-24149LL, 26611200LL, 2711LL, 25660800LL, -4201LL, 718502400LL, 0LL, 1LL, -4201LL, 5748019200LL, 2711LL, 179625600LL,
	-24149LL, 159667200LL, 176989LL, 179625600LL, -6782981LL, 1437004800LL, 352423LL, 19958400LL, -248945LL, 5225472LL,
	203617LL, 2332800LL, -1034059LL, 9676800LL, 203617LL, 2332800LL, -248945LL, 5225472LL, 352423LL, 19958400LL, -6782981LL,
	1437004800LL, 176989LL, 179625600LL, -24149LL, 159667200LL, 2711LL, 179625600LL, -4201LL, 5748019200LL, 0LL, 1LL,
	-2473LL, 2612736000LL, 2747LL, 163296000LL, -1363LL, 9676800LL, 4787LL, 6531840LL, -678739LL, 261273600LL, 37517LL,
	6048000LL, -12312353LL, 1306368000LL, 251539LL, 32659200LL, 0LL, 1LL, -251539LL, 32659200LL, 12312353LL, 1306368000LL,
	-37517LL, 6048000LL, 678739LL, 261273600LL, -4787LL, 6531840LL, 1363LL, 9676800LL, -2747LL, 163296000LL, 2473LL,
	2612736000LL, 0LL, 1LL, 2473LL, 20901888000LL, -2747LL, 1143072000LL, 1363LL, 58060800LL, -4787LL, 32659200LL, 678739LL,
	1045094400LL, -37517LL, 18144000LL, 12312353LL, 2612736000LL, -251539LL, 32659200LL, 4913051LL, 541900800LL, -251539LL,
	32659200LL, 12312353LL, 2612736000LL, -37517LL, 18144000LL, 678739LL, 1045094400LL, -4787LL, 32659200LL, 1363LL,
	58060800LL, -2747LL, 1143072000LL, 2473LL, 20901888000LL, 0LL, 1LL, -3813297421LL, 48771072000LL, 7202895013LL,
	5419008000LL, -194478164591LL, 18289152000LL, 64826056447LL, 1219276800LL, -12965212361LL, 69672960LL, 2528216801183LL,
	5225472000LL, -40130434061LL, 41472000LL, 9270132540661LL, 6096384000LL, -27810404151673LL, 14631321600LL, 370805458339LL,
	195084288LL, -3090045849497LL, 2032128000LL, 2528219438273LL, 2612736000LL, -842739795241LL, 1741824000LL, 9260876311LL,
	49766400LL, -38895677587LL, 731566080LL, 21608708209LL, 2032128000LL, -64826120477LL, 48771072000LL, 11439902983LL,
	146313216000LL, 984420287LL, 1741824000LL, -175719020767LL, 18289152000LL, 351438040399LL, 4572288000LL, -78097342019LL,
	203212800LL, 351438037823LL, 261273600LL, -4568694479497LL, 1306368000LL, 1522898158109LL, 217728000LL, -14358754072457LL,
	1306368000LL, 50255639380349LL, 3657830400LL, -4187969965007LL, 304819200LL, 50255639824297LL, 4572288000LL, -9137389105499LL,
	1306368000LL, 169210910161LL, 48384000LL, -351438045563LL, 261273600LL, 50205435229LL, 130636800LL, -234292031551LL,
	3048192000LL, 351438047819LL, 36578304000LL, -10336413181LL, 18289152000LL, -7325992007LL, 4064256000LL, 152217833917LL,
	4967424000LL, -616482227311LL, 2514758400LL, 182661400657LL, 149022720LL, -1369960504631LL, 319334400LL, 20035672374931LL,
	1796256000LL, -8904743275187LL, 399168000LL, 7123794618133LL, 203212800LL, -32057075773489LL, 731566080LL, 17809486537223LL,
	406425600LL, -185515484737LL, 5292000LL, 29142796145717LL, 1306368000LL, -47491964089LL, 4257792LL, 136996050263LL,
	31933440LL, -6164822262337LL, 5029516800LL, 2739921005753LL, 11176704000LL, -1369960503013LL, 44706816000LL, 145054641509LL,
	80472268800LL, 18116964721LL, 5474304000LL, -1616939101369LL, 28740096000LL, 1293551281111LL, 2874009600LL, -2155918801873LL,
	958003200LL, 45274294839607LL, 5748019200LL, -294282916457851LL, 14370048000LL, 65396203657069LL, 1596672000LL,
	-16816166654537LL, 261273600LL, 84080833271657LL, 1045094400LL, -875842013233LL, 10886400LL, 84080833268911LL, 1306368000LL,
	-588565832871701LL, 14370048000LL, 39237722190749LL, 1916006400LL, -22637147417369LL, 2874009600LL, 6467756404871LL,
	2874009600LL, -239546533511LL, 532224000LL, 6467756404741LL, 114960384000LL, -3804562591LL, 1149603840LL, -146456992991LL,
	38320128000LL, 32366995451051LL, 498161664000LL, -97100986353313LL, 186810624000LL, 5394499241861LL, 2075673600LL,
	-6865726307837LL, 754790400LL, 679706904477241LL, 28740096000LL, -226568968159517LL, 4790016000LL, 4045874431427LL,
	54432000LL, -13871569479199LL, 149299200LL, 32366995451503LL, 348364800LL, -32366995451531LL, 435456000LL, 339853452241253LL,
	7185024000LL, -25174329795653LL, 1064448000LL, 5809460722073LL, 638668800LL, -97100986354609LL, 37362124800LL, 735613532989LL,
	1415232000LL, -32366995451491LL, 498161664000LL, 815974675247LL, 213497856000LL, 424520564333LL, 149448499200LL,
	-25258973577811LL, 523069747200LL, 17182975223LL, 44478720LL, -72168495936601LL, 37362124800LL, 252589735778119LL,
	37362124800LL, -16839315718543LL, 958003200LL, 12629486788909LL, 359251200LL, -2061957026761LL, 37324800LL, 84196578592757LL,
	1219276800LL, -9021061992083LL, 130636800LL, 1804212398417LL, 32659200LL, -1347145257485LL, 38320128LL, 50517947155699LL,
	2874009600LL, -252589735778551LL, 37362124800LL, 3007020664031LL, 1556755200LL, -101035894311461LL, 261534873600LL,
	7216849593677LL, 149448499200LL, -70753427389LL, 24908083200LL, -990809370413LL, 747242496000LL, 117906315079141LL,
	5230697472000LL, -2911267038991LL, 16144128000LL, 18139433089097LL, 20118067200LL, -8421879648509LL, 2668723200LL,
	2183450279243LL, 266112000LL, -21437511832567LL, 1306368000LL, 33687518594033LL, 1306368000LL, -13100701675457LL,
	406425600LL, 117906315079111LL, 3657830400LL, -235812630158219LL, 9144576000LL, 1247685873853LL, 76032000LL, -29476578769777LL,
	3592512000LL, 29476578769777LL, 9340531200LL, -1247685873853LL, 1383782400LL, 235812630158219LL, 1307674368000LL,
	-9069716544547LL, 402361344000LL, 70057228211LL, 52835328000LL, 7431854439001LL, 20922789888000LL, -15792690682877LL,
	2615348736000LL, 8422768364201LL, 174356582400LL, -63170762731507LL, 261534873600LL, 18048789351859LL, 21349785600LL,
	-3509486818417LL, 1596672000LL, 126341525463011LL, 28740096000LL, -12634152546301LL, 1828915200LL, 42113841821003LL,
	4877107200LL, -3948172670719LL, 457228800LL, 126341525463007LL, 18289152000LL, -3008131558643LL, 684288000LL, 25268305092601LL,
	11496038400LL, -31585381365751LL, 37362124800LL, 4679315757889LL, 19372953600LL, -63170762731501LL, 1307674368000LL,
	126341525463001LL, 20922789888000LL, -2477284813LL, 6974263296LL, -874335816353LL, 20922789888000LL, 14863708878001LL,
	20922789888000LL, -14863708878001LL, 2615348736000LL, 14863708878001LL, 523069747200LL, -14863708878001LL, 149448499200LL,
	14863708878001LL, 57480192000LL, -14863708878001LL, 28740096000LL, 14863708878001LL, 18289152000LL, -14863708878001LL,
	14631321600LL, 14863708878001LL, 14631321600LL, -14863708878001LL, 18289152000LL, 14863708878001LL, 28740096000LL,
	-14863708878001LL, 57480192000LL, 14863708878001LL, 149448499200LL, -14863708878001LL, 523069747200LL, 14863708878001LL,
	2615348736000LL, -14863708878001LL, 20922789888000LL, 874335816353LL, 20922789888000LL
};

template<> struct _ci_matrix_data_wrapper<9> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_9; } };

constexpr long long _ci_matrix_data_10[800]{
	0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 1LL, 1LL, 0LL, 1LL, 0LL,
	1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, 0LL, 1LL, -1LL, 437580LL, 9LL, 194480LL,
	-9LL, 20020LL, 2LL, 715LL, -9LL, 715LL, 63LL, 1430LL, -7LL, 55LL, 18LL, 55LL, -9LL, 10LL, 0LL, 1LL, 9LL, 10LL, -18LL,
	55LL, 7LL, 55LL, -63LL, 1430LL, 9LL, 715LL, -2LL, 715LL, 9LL, 20020LL, -9LL, 194480LL, 1LL, 437580LL, 0LL, 1LL,
	1LL, 3938220LL, -9LL, 1555840LL, 9LL, 140140LL, -1LL, 2145LL, 9LL, 3575LL, -63LL, 5720LL, 7LL, 165LL, -9LL, 55LL,
	9LL, 10LL, -9778141LL, 6350400LL, 9LL, 10LL, -9LL, 55LL, 7LL, 165LL, -63LL, 5720LL, 9LL, 3575LL, -1LL, 2145LL, 9LL,
	140140LL, -9LL, 1555840LL, 1LL, 3938220LL, 0LL, 1LL, 63397LL, 18162144000LL, -10949LL, 155232000LL, 196909LL, 288288000LL,
	-9601741LL, 2270268000LL, 5861LL, 310464LL, -9381241LL, 144144000LL, 9072541LL, 49896000LL, -8190541LL, 19404000LL,
	3427741LL, 7056000LL, 0LL, 1LL, -3427741LL, 7056000LL, 8190541LL, 19404000LL, -9072541LL, 49896000LL, 9381241LL,
	144144000LL, -5861LL, 310464LL, 9601741LL, 2270268000LL, -196909LL, 288288000LL, 10949LL, 155232000LL, -63397LL,
	18162144000LL, 0LL, 1LL, -63397LL, 163459296000LL, 10949LL, 1241856000LL, -196909LL, 2018016000LL, 9601741LL, 13621608000LL,
	-5861LL, 1552320LL, 9381241LL, 576576000LL, -9072541LL, 149688000LL, 8190541LL, 38808000LL, -3427741LL, 7056000LL,
	117868837LL, 182891520LL, -3427741LL, 7056000LL, 8190541LL, 38808000LL, -9072541LL, 149688000LL, 9381241LL, 576576000LL,
	-5861LL, 1552320LL, 9601741LL, 13621608000LL, -196909LL, 2018016000LL, 10949LL, 1241856000LL, -63397LL, 163459296000LL,
	0LL, 1LL, -3739217LL, 2615348736000LL, 1043321LL, 36324288000LL, -11448761LL, 41513472000LL, 550937221LL, 326918592000LL,
	-21379409LL, 2905943040LL, 63114127LL, 2594592000LL, -444183529LL, 7185024000LL, 294484709LL, 2794176000LL, -95749481LL,
	1016064000LL, 0LL, 1LL, 95749481LL, 1016064000LL, -294484709LL, 2794176000LL, 444183529LL, 7185024000LL, -63114127LL,
	2594592000LL, 21379409LL, 2905943040LL, -550937221LL, 326918592000LL, 11448761LL, 41513472000LL, -1043321LL, 36324288000LL,
	3739217LL, 2615348736000LL, 0LL, 1LL, 3739217LL, 23538138624000LL, -1043321LL, 290594304000LL, 11448761LL, 290594304000LL,
	-550937221LL, 1961511552000LL, 21379409LL, 14529715200LL, -63114127LL, 10378368000LL, 444183529LL, 21555072000LL,
	-294484709LL, 5588352000LL, 95749481LL, 1016064000LL, -1886067737LL, 16460236800LL, 95749481LL, 1016064000LL, -294484709LL,
	5588352000LL, 444183529LL, 21555072000LL, -63114127LL, 10378368000LL, 21379409LL, 14529715200LL, -550937221LL, 1961511552000LL,
	11448761LL, 290594304000LL, -1043321LL, 290594304000LL, 3739217LL, 23538138624000LL, 0LL, 1LL, 4679LL, 19160064000LL,
	-139499LL, 28740096000LL, 2637347LL, 57480192000LL, -1311029LL, 4790016000LL, 131977LL, 114960384LL, -50693869LL,
	14370048000LL, 36951877LL, 4790016000LL, -160253299LL, 14370048000LL, 23225297LL, 2612736000LL, 0LL, 1LL, -23225297LL,
	2612736000LL, 160253299LL, 14370048000LL, -36951877LL, 4790016000LL, 50693869LL, 14370048000LL, -131977LL, 114960384LL,
	1311029LL, 4790016000LL, -2637347LL, 57480192000LL, 139499LL, 28740096000LL, -4679LL, 19160064000LL, 0LL, 1LL, -4679LL,
	172440576000LL, 139499LL, 229920768000LL, -2637347LL, 402361344000LL, 1311029LL, 28740096000LL, -131977LL, 574801920LL,
	50693869LL, 57480192000LL, -36951877LL, 14370048000LL, 160253299LL, 28740096000LL, -23225297LL, 2612736000LL, 91172887LL,
	8778792960LL, -23225297LL, 2612736000LL, 160253299LL, 28740096000LL, -36951877LL, 14370048000LL, 50693869LL, 57480192000LL,
	-131977LL, 574801920LL, 1311029LL, 28740096000LL, -2637347LL, 402361344000LL, 139499LL, 229920768000LL, -4679LL,
	172440576000LL, 0LL, 1LL, -2021LL, 97542144000LL, 7403LL, 18289152000LL, -156031LL, 41803776000LL, 65377LL, 3048192000LL,
	-248167LL, 2926264320LL, 309691LL, 1306368000LL, -1618681LL, 3483648000LL, 5586823LL, 9144576000LL, -66976673LL,
	146313216000LL, 0LL, 1LL, 66976673LL, 146313216000LL, -5586823LL, 9144576000LL, 1618681LL, 3483648000LL, -309691LL,
	1306368000LL, 248167LL, 2926264320LL, -65377LL, 3048192000LL, 156031LL, 41803776000LL, -7403LL, 18289152000LL, 2021LL,
	97542144000LL, 0LL, 1LL, 13101130993LL, 188116992000LL, -696980172439LL, 526727577600LL, 290408407081LL, 24385536000LL,
	-59243315530093LL, 877879296000LL, 29621658057251LL, 109734912000LL, -6582590747519LL, 8128512000LL, 1481082931201LL,
	783820800LL, -110023304019691LL, 31352832000LL, 128360521345439LL, 24385536000LL, -8471794361489381LL, 1316818944000LL,
	2117948568711407LL, 329204736000LL, -51344207052703LL, 9754214400LL, 385081547544131LL, 109734912000LL, -59243314250143LL,
	31352832000LL, 4897760717LL, 6048000LL, -59243313176521LL, 219469824000LL, 5924331286009LL, 87787929600LL, -1161633581249LL,
	97542144000LL, 871225183751LL, 658409472000LL, -183415827839LL, 2633637888000LL, -23887490861LL, 41803776000LL,
	1294348115909LL, 119218176000LL, -314526592172147LL, 3218890752000LL, 1782317355749573LL, 3218890752000LL, -71292694238897LL,
	32188907520LL, 5346952068999199LL, 804722688000LL, -1782317356820713LL, 114960384000LL, 472859707063681LL, 16422912000LL,
	-69510376961657287LL, 1609445376000LL, 308935008814627LL, 5852528640LL, -7723375222332383LL, 146313216000LL, 6319125183022217LL,
	146313216000LL, -23170125673173509LL, 804722688000LL, 1782317359494293LL, 114960384000LL, -30554011875493LL, 4598415360LL,
	1782317359245013LL, 804722688000LL, -1782317359058353LL, 3218890752000LL, 314526592742207LL, 3218890752000LL, -3883044354467LL,
	357654528000LL, 73573471973LL, 128755630080LL, 2533660983631LL, 1207084032000LL, -72209338033027LL, 1810626048000LL,
	3008722418021LL, 8382528000LL, -9919666638731LL, 4877107200LL, 1227558746533841LL, 150885504000LL, -38970118937353LL,
	1596672000LL, 818372497681681LL, 14370048000LL, -63833054819161811LL, 603542016000LL, 2127768493978987LL, 13412044800LL,
	-1329855308745409LL, 6858432000LL, 15958263705088241LL, 82301184000LL, -21277684940344631LL, 134120448000LL, 126652886551109LL,
	1197504000LL, -491023498634357LL, 8622028800LL, 2755462955327LL, 112896000LL, -1636744995478001LL, 201180672000LL,
	2455117493233243LL, 1207084032000LL, -24069779345543LL, 67060224000LL, 2406977934563LL, 60354201600LL, -2171709414649LL,
	1034643456000LL, -21853922190623LL, 4828336128000LL, 245359944594677LL, 2853107712000LL, -16193756343243887LL, 20922789888000LL,
	45882309639170831LL, 10461394944000LL, -135947584115983LL, 7749181440LL, 137646928917337913LL, 2615348736000LL,
	-91764619278155953LL, 747242496000LL, 45882309639042619LL, 201180672000LL, -275293857834053491LL, 804722688000LL,
	1835292385559159LL, 4389396480LL, -91764619277908957LL, 219469824000LL, 137646928916809637LL, 402361344000LL, -8342238116168303LL,
	36578304000LL, 1176469477921069LL, 9580032000LL, -11011754313341731LL, 209227898880LL, 45882309638931011LL, 2615348736000LL,
	-91764619277883113LL, 20922789888000LL, 8096878171580101LL, 10461394944000LL, -5397918781054901LL, 62768369664000LL,
	5682019769533LL, 1255367393280LL, 1346967533999LL, 213497856000LL, -1074880092131239LL, 8966909952000LL, 5643120483689189LL,
	5230697472000LL, -6090987188744047LL, 996323328000LL, 1582074594479LL, 64696320LL, -54818884698697657LL, 747242496000LL,
	3553075860100751LL, 20756736000LL, -18272961566232097LL, 57480192000LL, 27409442349347339LL, 57480192000LL, -8527382064241063LL,
	14631321600LL, 4568240391557501LL, 7838208000LL, -54818884698687199LL, 114960384000LL, 435070513481621LL, 1368576000LL,
	-4737434480132951LL, 27675648000LL, 2740944234933923LL, 37362124800LL, -26367909907973LL, 1078272000LL, 63955365481785863LL,
	10461394944000LL, -3224640276392453LL, 2988969984000LL, 89573341010899LL, 747242496000LL, -11314527285587LL, 1793381990400LL,
	-158478015631867LL, 26900729856000LL, 1621352006079877LL, 14485008384000LL, -7025858693012837LL, 6974263296000LL,
	358318793343656777LL, 62768369664000LL, -27562984103358383LL, 1207084032000LL, 119439597781220399LL, 1743565824000LL,
	-27562984103358719LL, 172440576000LL, 51188399049095051LL, 172440576000LL, -1206460583648711LL, 2709504000LL, 358318793343668729LL,
	658409472000LL, -358318793343670007LL, 658409472000LL, 119439597781223659LL, 268240896000LL, -358318793343671627LL,
	1207084032000LL, 358318793343671957LL, 2241727488000LL, -1312523052540923LL, 19160064000LL, 358318793343671717LL,
	15692092416000LL, -358318793343671207LL, 62768369664000LL, 180150222897773LL, 178827264000LL, -21077576079039391LL,
	188305108992000LL, 7757665100861LL, 1316818944000LL, 14448695593637LL, 3923023104000LL, -399309405496877LL, 5706215424000LL,
	658860519069847LL, 1046139494400LL, -37335429413957999LL, 10461394944000LL, 2074190522997667LL, 145297152000LL,
	-224012576483748103LL, 5230697472000LL, 333352048338911LL, 3335904000LL, -746708588279161LL, 4023613440LL, 28001572060468553LL,
	100590336000LL, -74670858827916187LL, 219469824000LL, 18667714706979059LL, 54867456000LL, -112006288241874431LL,
	402361344000LL, 339412994672347LL, 1828915200LL, -3555755182281733LL, 35582976000LL, 28001572060468667LL, 653837184000LL,
	-4666928676744781LL, 326918592000LL, 291683042296549LL, 81729648000LL, -2635442076279409LL, 4184557977600LL, 1098100865116421LL,
	15692092416000LL, -115589564749097LL, 31384184832000LL, -186526017023207LL, 125536739328000LL, 15061975874623963LL,
	533531142144000LL, -25820530070783933LL, 101624979456000LL, 5020658624874653LL, 3487131648000LL, -60247903498495829LL,
	10461394944000LL, 922161788242283LL, 53374464000LL, -4634454115268909LL, 114960384000LL, 152141170450747LL, 2032128000LL,
	-180743710495487423LL, 1609445376000LL, 2151710839231993LL, 15676416000LL, -60247903498495801LL, 438939648000LL,
	45185927623871849LL, 402361344000LL, -2868947785642657LL, 38320128000LL, 15061975874623949LL, 373621248000LL, -180743710495487387LL,
	10461394944000LL, 15061975874623949LL, 2615348736000LL, -2868947785642657LL, 1992646656000LL, 2657995742580697LL,
	10461394944000LL, -5477082136226891LL, 194011324416000LL, 8711379915919LL, 5862979584000LL, 374370961900291LL, 1067062284288000LL,
	-42678289656633173LL, 6402373705728000LL, 10669572414158293LL, 177843714048000LL, -14226096552211057LL, 41845579776000LL,
	4267828965663317LL, 3138418483200LL, -554263502034197LL, 135862272000LL, 296377011504397LL, 31135104000LL, -42678289656633167LL,
	2414168064000LL, 21339144828316583LL, 804722688000LL, -2845219310442211LL, 87787929600LL, 10669572414158291LL, 329204736000LL,
	-42678289656633163LL, 1609445376000LL, 1016149753729361LL, 57480192000LL, -42678289656633161LL, 4483454976000LL,
	1066957241415829LL, 261534873600LL, -1580677394690117LL, 1162377216000LL, 1939922257119689LL, 5706215424000LL, -42678289656633157LL,
	711374856192000LL, 3556524138052763LL, 533531142144000LL, -9168268454701LL, 26132137574400LL, -236444818042289LL,
	6402373705728000LL, 4492451542803491LL, 6402373705728000LL, -4492451542803491LL, 711374856192000LL, 4492451542803491LL,
	125536739328000LL, -4492451542803491LL, 31384184832000LL, 4492451542803491LL, 10461394944000LL, -4492451542803491LL,
	4483454976000LL, 4492451542803491LL, 2414168064000LL, -4492451542803491LL, 1609445376000LL, 4492451542803491LL,
	1316818944000LL, -4492451542803491LL, 1316818944000LL, 4492451542803491LL, 1609445376000LL, -4492451542803491LL,
	2414168064000LL, 4492451542803491LL, 4483454976000LL, -4492451542803491LL, 10461394944000LL, 4492451542803491LL,
	31384184832000LL, -4492451542803491LL, 125536739328000LL, 4492451542803491LL, 711374856192000LL, -4492451542803491LL,
	6402373705728000LL, 236444818042289LL, 6402373705728000LL
};

template<> struct _ci_matrix_data_wrapper<10> { static constexpr const long long* _data_ptr() noexcept { return _ci_matrix_data_10; } };
////////////////////////////////////////////////////////////////////////////////
// END OF AUTOMATICALLY GENERATED DATA
////////////////////////////////////////////////////////////////////////////////

template<typename _pElemType, int _pHeight, int _pWidth>
struct _matrix
{
	constexpr _pElemType& operator()(int _aIndex) { return _mData[_aIndex]; }
	constexpr const _pElemType& operator()(int _aIndex) const { return _mData[_aIndex]; }

	constexpr _pElemType& operator()(int _aRow, int _aCol) { return _mData[_aRow + _pHeight * _aCol]; }
	constexpr const _pElemType& operator()(int _aRow, int _aCol) const { return _mData[_aRow + _pHeight * _aCol]; }

	_pElemType _mData[_pHeight * _pWidth];
};

template<typename _pElemType, int _pHeight, int _pMid, int _pWidth>
constexpr auto operator*(const _matrix<_pElemType, _pHeight, _pMid>& _aL, const _matrix<_pElemType, _pMid, _pWidth>& _aR)
{
	_matrix<_pElemType, _pHeight, _pWidth> _lRet{ };
	for (int _lCol = 0; _lCol < _pWidth; ++_lCol) {
		for (int _lRow = 0; _lRow < _pHeight; ++_lRow) {
			_lRet(_lRow, _lCol) = _aL(_lRow, 0) * _aR(0, _lCol);
		}
		for (int _lI = 1; _lI < _pMid; ++_lI) {
			for (int _lRow = 0; _lRow < _pHeight; ++_lRow) {
				_lRet(_lRow, _lCol) += _aL(_lRow, _lI) * _aR(_lI, _lCol);
			}
		}
	}
	return _lRet;
}

template<typename _pReal, int _pSmth>
constexpr auto _get_typed_ci_matrix()
{
	constexpr int _lWidth = 2 * _pSmth;
	_matrix<_pReal, _lWidth, _lWidth> _lRet{ };
	// Pulling this out of the loop, to ensure that the function is only constexpr if this expression is
	const long long* _lPtr = _ci_matrix_data_wrapper<_pSmth>::_data_ptr();
	_lRet(0) = static_cast<_pReal>(_lPtr[0]) / static_cast<_pReal>(_lPtr[1]);
	_lPtr += 2;
	for (int _lIndex = 1; _lIndex < _lWidth * _lWidth; ++_lIndex, _lPtr += 2) {
		_lRet(_lIndex) = static_cast<_pReal>(_lPtr[0]) / static_cast<_pReal>(_lPtr[1]);
	}
	return _lRet;
}

struct _true_tag { static constexpr bool _value = true; };
struct _false_tag { static constexpr bool _value = false; };
template<typename _pType, int _pInt>
struct _type_int_tag { };

template<typename _pReal, int _pSmth>
struct _ceval_tester
{
	constexpr int operator()() const
	{
		auto _lTmp = _get_typed_ci_matrix<_pReal, _pSmth>();
		(void)_lTmp;
		return 0;
	}
};

/*
The SFINAE hack works by trying to evaluate the corresponding expression in a
template parameter. If `_get_typed_ci_matrix` turns out to be constant
evaluable, the template version of `_ceval_helper` will be selected, otherwise,
the non-template version.
*/
template<typename _pReal, int _pSmth, int = (_ceval_tester<_pReal, _pSmth>{ }()) >
_true_tag _ceval_helper(_type_int_tag<_pReal, _pSmth>) noexcept;
_false_tag _ceval_helper(...) noexcept;

template<typename _pReal, int _pSmth>
constexpr bool _const_evaluable_v = decltype(_ceval_helper(_type_int_tag<_pReal, _pSmth>{ }))::_value;

/*
Two template specializations: one for `constexpr`, one for `const`.
*/
template<typename _pReal, int _pSmth, bool _pConst = _const_evaluable_v<_pReal, _pSmth>>
struct _ci_matrix_cache;

template<typename _pReal, int _pSmth>
struct _ci_matrix_cache<_pReal, _pSmth, true>
{
	static constexpr _matrix<_pReal, (2 * _pSmth), (2 * _pSmth)> _instance = _get_typed_ci_matrix<_pReal, _pSmth>();
};

// Why is this even necessary???
template<typename _pReal, int _pSmth>
constexpr _matrix<_pReal, (2 * _pSmth), (2 * _pSmth)> _ci_matrix_cache<_pReal, _pSmth, true>::_instance;

template<typename _pReal, int _pSmth>
struct _ci_matrix_cache<_pReal, _pSmth, false>
{
	static const _matrix<_pReal, (2 * _pSmth), (2 * _pSmth)> _instance;
};

template<typename _pReal, int _pSmth>
const _matrix<_pReal, (2 * _pSmth), (2 * _pSmth)> _ci_matrix_cache<_pReal, _pSmth, false>::_instance = _get_typed_ci_matrix<_pReal, _pSmth>();

template<typename _pReal, int _pSmth>
constexpr const auto& _typed_ci_matrix() noexcept
{
	return _ci_matrix_cache<_pReal, _pSmth>::_instance;
}

template<typename _pReal, int _pN>
constexpr auto _arg_vector(const _pReal& _aX)
{
	// TODO : is there a faster (more SIMD-friendly) version?
	_matrix<_pReal, _pN, 1> _lRet{ };
	_lRet(0) = static_cast<_pReal>(1);
	_lRet(1) = _aX;
	for (int _lI = 2; _lI < _pN; ++_lI) {
		_lRet(_lI) = _lRet(_lI - 1) * _aX;
	}
	return _lRet;
}

template<typename _pType, int>
using _map_to_type = _pType;

template<typename _pReal, int ... _pN>
struct _interpolator;

template<typename _pReal>
struct _interpolator<_pReal>
{
public:
	template<typename _pFunc>
	constexpr _pReal _interpolate(_pFunc _aFun) const
	{
		return _aFun();
	}
};

template<typename _pReal, int _pN0, int ... _pN>
struct _interpolator<_pReal, _pN0, _pN...> : private _interpolator<_pReal, _pN...>
{
public:

	constexpr _interpolator(const _matrix<_pReal, (2 * _pN0), 1>& _aX, const _matrix<_pReal, (2 * _pN), 1>&... _aArgs)
		: _interpolator<_pReal, _pN...>(_aArgs...)
		, _mVecX(_typed_ci_matrix<_pReal, _pN0>()* _aX)
	{ }

	template<typename _pFunc>
	constexpr _pReal _interpolate(_pFunc _aFun) const
	{
		_matrix<_pReal, 1, (2 * _pN0)> _lVec{ };
		for (int _lX = 0; _lX < 2 * _pN0; ++_lX) {
			_lVec(_lX) = _interpolator<_pReal, _pN...>::_interpolate(
				[&_aFun, _lX](decltype(_pN)... _aIds) { return _aFun(_lX - _pN0 + 1, _aIds...); });
		}
		return (_lVec * _mVecX)(0);
	}

private:
	_matrix<_pReal, (2 * _pN0), 1> _mVecX;
};

template<typename _pReal, int ... _pN>
struct _interpolate_impl
{
	template<typename _pFunc>
	constexpr _pReal operator()(_pFunc&& _aFun, const _map_to_type<_pReal, _pN>&... _aArgs) const
	{
		_interpolator<_pReal, _pN...> _lInterpolator{ _arg_vector<_pReal, (2 * _pN)>(_aArgs)... };
		return _lInterpolator._interpolate(static_cast<_pFunc&&>(_aFun));
	}
};

}

/*
Choosing a functor instead of a function so that we can call it with a generic
function argument without specifying its type.
*/
template<typename _pRealType, int ... _pN>
constexpr _detail::_interpolate_impl<_pRealType, _pN...> interpolate{ };


/*
Some sample functions. All of these should compile without any warnings
whatsoever. Tested with:
	clang -Wall -Wextra -pedantic
	gcc -Wall -Wextra -pedantic
	MSVC /W4
Replace the 0 with a 1 and see if the compiler complains. Compile time may be
extremely high especially when enabling aggressive optimisation.
*/
#if 0
#define Instance1(Ident, T, D0) \
T Ident(const T (&_aArgs)[2 * D0], T _aX) { \
	return interpolate<T, D0>( \
		[&_aArgs](int _aI){ \
			return _aArgs[_aI + D0 - 1]; }, \
		_aX); \
}

#define Instance2(Ident, T, D0, D1) \
T Ident(const T (&_aArgs)[2 * D0][2 * D1], T _aX, T _aY) { \
	return interpolate<T, D0, D1>( \
		[&_aArgs](int _aI, int _aJ){ \
			return _aArgs[_aI + D0 - 1][_aJ + D1 - 1]; }, \
		_aX, _aY); \
}

#define Instance3(Ident, T, D0, D1, D2) \
T Ident(const T (&_aArgs)[2 * D0][2 * D1][2 * D2], T _aX, T _aY, T _aZ) { \
	return interpolate<T, D0, D1, D2>( \
		[&_aArgs](int _aI, int _aJ, int _aK){ \
			return _aArgs[_aI + D0 - 1][_aJ + D1 - 1][_aK + D2 - 1]; }, \
		_aX, _aY, _aZ); \
}

#define Instance4(Ident, T, D0, D1, D2, D3) \
T Ident(const T (&_aArgs)[2 * D0][2 * D1][2 * D2][2 * D3], T _aX, T _aY, T _aZ, T _aW) { \
	return interpolate<T, D0, D1, D2, D3>( \
		[&_aArgs](int _aI, int _aJ, int _aK, int _aL){ \
			return _aArgs[_aI + D0 - 1][_aJ + D1 - 1][_aK + D2 - 1][_aL + D3 - 1]; }, \
		_aX, _aY, _aZ, _aW); \
}

#define Instance5(Ident, T, D0, D1, D2, D3, D4) \
T Ident(const T (&_aArgs)[2 * D0][2 * D1][2 * D2][2 * D3][2 * D4], T _aX, T _aY, T _aZ, T _aW, T _aV) { \
	return interpolate<T, D0, D1, D2, D3, D4>( \
		[&_aArgs](int _aI, int _aJ, int _aK, int _aL, int _aM){ \
			return _aArgs[_aI + D0 - 1][_aJ + D1 - 1][_aK + D2 - 1][_aL + D3 - 1][_aM + D4 - 1]; }, \
		_aX, _aY, _aZ, _aW); \
}

Instance1(_testf1, float, 1)
Instance1(_testf2, float, 2)
Instance1(_testf3, float, 3)
Instance1(_testf4, float, 4)

Instance2(_testf11, float, 1, 1)
Instance2(_testf22, float, 2, 2)
Instance2(_testf33, float, 3, 3)
Instance2(_testf44, float, 4, 4)

Instance3(_testf111, float, 1, 1, 1)
Instance3(_testf222, float, 2, 2, 2)
Instance3(_testf333, float, 3, 3, 3)
Instance3(_testf444, float, 4, 4, 4)

Instance3(_testf232, float, 2, 3, 2)
Instance3(_testf324, float, 3, 2, 4)

Instance1(_testd1, double, 1)
Instance1(_testd2, double, 2)
Instance1(_testd3, double, 3)
Instance1(_testd4, double, 4)

Instance2(_testd11, double, 1, 1)
Instance2(_testd22, double, 2, 2)
Instance2(_testd33, double, 3, 3)
Instance2(_testd44, double, 4, 4)

Instance3(_testd111, double, 1, 1, 1)
Instance3(_testd222, double, 2, 2, 2)
Instance3(_testd333, double, 3, 3, 3)
Instance3(_testd444, double, 4, 4, 4)

Instance3(_testd232, double, 2, 3, 2)
Instance3(_testd324, double, 3, 2, 4)

Instance1(_testl1, long double, 1)
Instance1(_testl2, long double, 2)
Instance1(_testl3, long double, 3)
Instance1(_testl4, long double, 4)

Instance2(_testl11, long double, 1, 1)
Instance2(_testl22, long double, 2, 2)
Instance2(_testl33, long double, 3, 3)
Instance2(_testl44, long double, 4, 4)

Instance3(_testl111, long double, 1, 1, 1)
Instance3(_testl222, long double, 2, 2, 2)
Instance3(_testl333, long double, 3, 3, 3)
Instance3(_testl444, long double, 4, 4, 4)

Instance3(_testl232, long double, 2, 3, 2)
Instance3(_testl324, long double, 3, 2, 4)

Instance4(_testf4567, float, 4, 5, 6, 7)
Instance4(_testd5432, double, 5, 4, 3, 2)
Instance4(_testl1925, long double, 1, 9, 2, 5)

Instance5(_testda9876, double, 10, 9, 8, 7, 6)

#undef Instance5
#undef Instance4
#undef Instance3
#undef Instance2
#undef Instance1
#endif

}
}

#endif
